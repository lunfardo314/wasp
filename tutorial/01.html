<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Solo package - ISCP Documentation</title>
        
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../welcome.html"><strong aria-hidden="true">1.</strong> Welcome</a></li><li class="chapter-item expanded "><a href="../tutorial/index.html"><strong aria-hidden="true">2.</strong> Tutorials</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorial/01.html" class="active"><strong aria-hidden="true">2.1.</strong> The Solo package</a></li><li class="chapter-item expanded "><a href="../tutorial/02.html"><strong aria-hidden="true">2.2.</strong> Tokens and the UTXO Ledger</a></li><li class="chapter-item expanded "><a href="../tutorial/03.html"><strong aria-hidden="true">2.3.</strong> Creating a chain; Core contracts</a></li><li class="chapter-item expanded "><a href="../tutorial/04.html"><strong aria-hidden="true">2.4.</strong> Deploying and running a Rust smart contract</a></li><li class="chapter-item expanded "><a href="../tutorial/05.html"><strong aria-hidden="true">2.5.</strong> Structure of the smart contract</a></li><li class="chapter-item expanded "><a href="../tutorial/06.html"><strong aria-hidden="true">2.6.</strong> Invoking smart contracts. Sending a request</a></li><li class="chapter-item expanded "><a href="../tutorial/07.html"><strong aria-hidden="true">2.7.</strong> Invoking smart contracts. Calling a view</a></li><li class="chapter-item expanded "><a href="../tutorial/08.html"><strong aria-hidden="true">2.8.</strong> Accounts: deposit and withdraw tokens</a></li><li class="chapter-item expanded "><a href="../tutorial/09.html"><strong aria-hidden="true">2.9.</strong> Sending tokens to the smart contract</a></li><li class="chapter-item expanded "><a href="../tutorial/10.html"><strong aria-hidden="true">2.10.</strong> Return of tokens in case of failure</a></li><li class="chapter-item expanded "><a href="../tutorial/11.html"><strong aria-hidden="true">2.11.</strong> Sending tokens from smart contract to address</a></li></ol></li><li class="chapter-item expanded "><a href="../setup_wasp.html"><strong aria-hidden="true">3.</strong> Setup a private ISCP Cluster</a></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">ISCP Documentation</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                            </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="exploring-iota-smart-contracts"><a class="header" href="#exploring-iota-smart-contracts">Exploring IOTA Smart Contracts</a></h1>
<h2 id="the-solo-package"><a class="header" href="#the-solo-package">The <em>Solo</em> package</a></h2>
<p>Solo is a Go package to write tests for IOTA smart contracts. It allows the
deployment of ISCP chains and smart contracts. It also provides a toolkit for
interaction with smart contracts, for manipulation of tokens and ledger accounts
in an environment that is almost identical to the distributed multi-chain
environment of the ISCP.</p>
<p>The <code>Solo</code> package and its <code>GoDoc</code> link 
<a href="../../packages/solo/readme.html">can be found here</a>. The GoDocs provides a
reference to all Solo calls which can be used in tests (not necessarily covered
in this tutorial).</p>
<p>Smart contracts are notoriously isolated from the outside world. The effect of
the user interaction with a smart contract is normally only observed in its
state change. The approach in this tutorial is to explain all main concepts of
ISCP development through loading smart contracts into the <em>Solo</em> tests, invoking
its functions and examining state changes.</p>
<p>ISCP is currently in active development, so things change and are less than
perfect. In the current stage the ISCP software is experimental. We expect
feedback from the community about hands-on experience. We also expect
contribution to the development of ISCP itself, including Rust/Wasm development
environment or, possibly, alternative VM implementations.</p>
<p><em>Solo</em> is not a toy environment. It allows developers to develop and test real
smart contracts and entire inter-chain protocols before deploying them on the
distributed network.</p>
<p>Please follow <a href="install.html">the link</a> for installation instructions.</p>
<h2 id="first-example"><a class="header" href="#first-example">First example</a></h2>
<p>The following is an example of a <em>Solo</em> test. It deploys a new chain and invokes
a function in the <code>root</code> contract.</p>
<p>The <code>root</code> contract always exists on any chain. So for this example there is no
need to deploy any new contract. The test log to the testing output the main
parameters of the chain, lists names and IDs of all four core contracts.</p>
<pre><code class="language-go">func TestTutorial1(t *testing.T) {
    env := solo.New(t, false, false)
    chain := env.NewChain(nil, &quot;ex1&quot;)
    
    chainID, chainOwnerID, coreContracts := chain.GetInfo()                      // calls view root::GetChainInfo
    require.EqualValues(t, len(core.AllCoreContractsByHash), len(coreContracts)) // all core contracts deployed by default
    
    t.Logf(&quot;chain ID: %s&quot;, chainID.String())
    t.Logf(&quot;chain owner ID: %s&quot;, chainOwnerID.String())
    for hname, rec := range coreContracts {
        t.Logf(&quot;    Core contract '%s': %s&quot;, rec.Name, coretypes.NewAgentID(chainID.AsAddress(), hname))
    }
}
</code></pre>
<p>The output of the test will be something like this:</p>
<pre><code>=== RUN   TestTutorial1
21:46.217	INFO	TestTutorial1	solo/solo.go:140	Solo environment created with initial logical time 2021-04-27 12:21:46.2163941 -0700 PDT m=+0.004574501
21:46.217	INFO	TestTutorial1	solo/solo.go:187	deploying new chain 'ex1'. ID: $/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU, state controller address: 16e5mTcM9ufZQP37Ki55NhDLacLpTToieKkeqR5my8cu4
21:46.217	INFO	TestTutorial1	solo/solo.go:189	     chain '$/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU'. state controller address: 16e5mTcM9ufZQP37Ki55NhDLacLpTToieKkeqR5my8cu4
21:46.217	INFO	TestTutorial1	solo/solo.go:190	     chain '$/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU'. originator address: 1ECjLLrXYpDKTgtFfft4rFUsd7qkaXQw1Worm4oESzKVi
21:46.218	INFO	TestTutorial1.ex1	vmcontext/runreq.go:311	eventlog -&gt; '[req] [0]Hy2CGQEi6YHLE3acQoaUe9t2Ej85txq3gG35TCNDas9f: Ok'
21:46.218	INFO	TestTutorial1	solo/clock.go:35	AdvanceClockBy: logical clock advanced by 2ns
21:46.218	INFO	TestTutorial1.ex1.m	mempool/mempool.go:119	OUT MEMPOOL [0]Hy2CGQEi6YHLE3acQoaUe9t2Ej85txq3gG35TCNDas9f
21:46.218	INFO	TestTutorial1.ex1	solo/run.go:86	state transition #0 --&gt; #1. Requests in the block: 1. Outputs: 1
21:46.218	INFO	TestTutorial1	solo/clock.go:44	ClockStep: logical clock advanced by 1ms
21:46.218	INFO	TestTutorial1.ex1	solo/solo.go:245	chain 'ex1' deployed. Chain ID: $/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU
21:46.218	INFO	TestTutorial1.ex1	solo/req.go:243	callView: root::getChainInfo
    tutorial_test.go:24: chain ID: $/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU
    tutorial_test.go:25: chain owner ID: A/1ECjLLrXYpDKTgtFfft4rFUsd7qkaXQw1Worm4oESzKVi::00000000
    tutorial_test.go:27:     Core contract '_default': A/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU::00000000
    tutorial_test.go:27:     Core contract 'accounts': A/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU::3c4b5e02
    tutorial_test.go:27:     Core contract 'blob':     A/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU::fd91bc63
    tutorial_test.go:27:     Core contract 'blocklog': A/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU::f538ef2b
    tutorial_test.go:27:     Core contract 'eventlog': A/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU::661aa7d8
    tutorial_test.go:27:     Core contract 'root':     A/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU::cebf5908
--- PASS: TestTutorial1 (0.00s)
</code></pre>
<p>The core contracts listed in the log (<code>_default</code>, <code>accounts</code>, <code>blob</code>, <code>blocklog</code>
, <code>eventlog</code>, <code>root</code>) are automatically deployed on each new chain. You can see
them listed in the test log together with their <em>contract IDs</em>.</p>
<p>The output fragment in the log <code>state transition #0 --&gt; #1</code> means the state of
the chain has changed from block index 0 (the origin index of the empty state)
to block index 1. The state #0 is the empty origin state, the #1 always contains
all core smart contracts deployed on the chain as well as other variables of
chain, such as <em>chainID</em> and <em>chain owner ID</em>.</p>
<p>The <em>chain ID</em> and <em>chain owner ID</em> are respectively ID of the deployed
chain <code>$/iGBuy2yPUpdjX8p8ZXoAkHeFhW7bkrR1dwavWB4CknMU</code> and the address (in the
form of <em>agent ID</em>) from which the chain was deployed:
<code>A/1ECjLLrXYpDKTgtFfft4rFUsd7qkaXQw1Worm4oESzKVi::00000000</code> (the prefixes <code>$/</code>
and <code>A/</code> indicate that what follow are a chain ID and an agent ID, respectively)
.</p>
<p>Next: <a href="02.html">Tokens and the UTXO Ledger</a></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../tutorial/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../tutorial/02.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../tutorial/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../tutorial/02.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
                
        
        
                <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
